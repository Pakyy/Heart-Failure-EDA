---
title: "Data Visualization Exam"
author: "Pasquale Gravante & Antonio Mastroianni"
date: "2022-10-24"
output: html_document
---

The dataset consists of data regarding **299 patients** possibly affected by cardiovascular deseases.
The variables taken into account for the analysis are:
* **Age**
* **Sex**
* 
* **Anaemia**: decrease of red blood cells or haemoglobin **(Boolean)**
* **Creatinine_phosphokinase**: level of the CPK enzyme in the blood **(mcg/L)**
* **Diabetes**: whether the patient has diabetes **(Bolean)**
* **Ejection_fraction**: Percentage of blood leaving the heart at each contraction
* **high_blood_pressure**: whether the patient suffers from hypertension
* **Platelets**: Platelets in the blood **(kiloplatelets/mL)*
* **serum_creatinine**: Level of serum creatinine in the blood **(mg/dL)**
* **serum_sodium**: Level of serum sodium in the blood **(mEq/L)**
* **Smoking**: If the patient smokes or not **(Boolean)**
* **Time**: Follow-up period **(days)**

```{r Library}
library(ggplot2)
library(dplyr)
library(tidyverse)
library(tidyr)
```

```{r}
glimpse(heart)
```

```{r Editing column type}
for (i in c(2,4,6,10,11,13)){
  heart[,i] = as.factor(heart[,i])
}
glimpse(heart)
```

```{r}
data.frame(unclass(summary(heart)), check.names = FALSE, stringsAsFactors = FALSE)
```

```{r Age histogram}
ggplot(heart, aes(x = age)) +
  geom_histogram(aes(y = ..density..), binwidth = 10, fill = 'cyan3', color = 'white') +
  theme_minimal() + 
  geom_vline(xintercept = mean(heart$age), color = 'deeppink2') +
  labs(x = 'Age', y='Density')+
  scale_x_continuous(breaks= c(35, 45,55,65,75,85,95))
```

```{r}
ggplot(heart, aes(x = creatinine_phosphokinase)) +
  geom_histogram(aes(y = ..density..), binwidth = 100, fill = 'cyan3', color = 'white') +
  theme_minimal() + 
  geom_vline(xintercept = mean(heart$creatinine_phosphokinase), color = 'deeppink2') +
  geom_vline(xintercept = median(heart$creatinine_phosphokinase), color = 'purple') +
  labs(x = 'CPK', y='Density')
```

```{r Age Boxplot according to sex}
ggplot(heart, aes(x=sex, y = age, fill = sex))+
  geom_boxplot()+
  theme_classic()+
  scale_y_continuous(breaks=c(40, 50, 60, 70, 80, 90))
```

```{r}
attach(heart)
male_data = filter(heart, sex == 1 )
female_data = filter(heart, sex == 0)
```
